{% extends "base.html" %}
{% load static %}

{% block title %}AgriTrade Africa - Organic Farm Products{% endblock %}

{% block extra_css %}
<!-- Google Web Fonts -->
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Roboto:wght@500;700&display=swap" rel="stylesheet">

<!-- Icon Font Stylesheet -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/all.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

<!-- Libraries Stylesheet -->
<link href="{% static 'lib/owlcarousel/assets/owl.carousel.min.css' %}" rel="stylesheet">

<!-- Customized Bootstrap Stylesheet -->
<link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">

<!-- Template Stylesheet -->
<link href="{% static 'css/style.css' %}" rel="stylesheet">

<!-- Ionicons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/4.5.6/css/ionicons.min.css">
{% endblock %}

{% block content %}


<!-- Carousel Start -->
<div class="container-fluid p-0">
    <div id="header-carousel" class="carousel slide carousel-fade" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img class="w-100" src="{% static 'img/carousel-1.jpg' %}" alt="Organic Vegetables">
                <div class="carousel-caption top-0 bottom-0 start-0 end-0 d-flex flex-column align-items-center justify-content-center">
                    <div class="text-start p-5" style="max-width: 900px;">
                        <h3 class="text-white">Organic Vegetables</h3>
                        <h1 class="display-1 text-white mb-md-4">Organic Vegetables For Healthy Life</h1>
                        <a href="#products" class="btn btn-primary py-md-3 px-md-5 me-3">Explore</a>
                        <a href="#contact" class="btn btn-secondary py-md-3 px-md-5">Contact</a>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <img class="w-100" src="{% static 'img/carousel-2.jpg' %}" alt="Organic Fruits">
                <div class="carousel-caption top-0 bottom-0 start-0 end-0 d-flex flex-column align-items-center justify-content-center">
                    <div class="text-start p-5" style="max-width: 900px;">
                        <h3 class="text-white">Organic Fruits</h3>
                        <h1 class="display-1 text-white mb-md-4">Organic Fruits For Better Health</h1>
                        <a href="#products" class="btn btn-primary py-md-3 px-md-5 me-3">Explore</a>
                        <a href="#contact" class="btn btn-secondary py-md-3 px-md-5">Contact</a>
                    </div>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#header-carousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#header-carousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</div>
<!-- Carousel End -->

<!-- Banner Start -->
<div class="container-fluid banner mb-5">
    <div class="container">
        <div class="row gx-0">
            <div class="col-md-6">
                <div class="bg-primary bg-vegetable d-flex flex-column justify-content-center p-5" style="height: 300px;">
                    <h3 class="text-white mb-3">Organic Vegetables</h3>
                    <p class="text-white">Organic vegetables enriched with vitamin C nutrients and chemical free natural products</p>
                    <a class="text-white fw-bold" href="#vegetables">Read More<i class="bi bi-arrow-right ms-2"></i></a>
                </div>
            </div>
            <div class="col-md-6">
                <div class="bg-secondary bg-fruit d-flex flex-column justify-content-center p-5" style="height: 300px;">
                    <h3 class="text-white mb-3">Organic Fruits</h3>
                    <p class="text-white">Grown on Africa's Fertile soils enriched with natural Nutrients</p>
                    <a class="text-white fw-bold" href="#fruits">Read More<i class="bi bi-arrow-right ms-2"></i></a>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Banner End -->

<!-- Category Section Start -->
<section class="ftco-section ftco-category ftco-no-pt">
    <div class="container">
        <div class="row">
            <div class="col-md-8">
                <div class="row">
                    <div class="col-md-6 order-md-last align-items-stretch d-flex">
                        <div class="category-wrap-2 ftco-animate img align-self-stretch d-flex" style="background-image: url('{% static 'img/category.jpg' %}');">
                            <div class="text text-center">
                                <h2>Vegetables</h2>
                                <p>Protect the health of every home</p>
                                <p><a href="{% url 'core:products' %}" class="btn btn-primary">Shop now</a></p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="category-wrap ftco-animate img mb-4 d-flex align-items-end" style="background-image: url('{% static 'img/category-1.jpg' %}');">
                            <div class="text px-3 py-1">
                                <h2 class="mb-0"><a href="#fruits">Fruits</a></h2>
                            </div>
                        </div>
                        <div class="category-wrap ftco-animate img d-flex align-items-end" style="background-image: url('{% static 'img/category-2.jpg' %}');">
                            <div class="text px-3 py-1">
                                <h2 class="mb-0"><a href="#vegetables">Vegetables</a></h2>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="category-wrap ftco-animate img mb-4 d-flex align-items-end" style="background-image: url('{% static 'img/category-3.jpg' %}');">
                    <div class="text px-3 py-1">
                        <h2 class="mb-0"><a href="#juices">Juices</a></h2>
                    </div>
                </div>
                <div class="category-wrap ftco-animate img d-flex align-items-end" style="background-image: url('{% static 'img/category-4.jpg' %}');">
                    <div class="text px-3 py-1">
                        <h2 class="mb-0"><a href="#dried">Dried</a></h2>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Category Section End -->

<!-- Products Carousel Start -->
<div id="products" class="container-fluid py-5">
    <div class="container">
        <div class="mx-auto text-center mb-5" style="max-width: 500px;">
            <h6 class="text-primary text-uppercase">Products</h6>
            <h1 class="display-5">Our Fresh & Organic Products</h1>
        </div>
        <div class="owl-carousel product-carousel px-5">
            {% for item in featured_items|slice:":5" %}
            <div class="pb-5">
                <div class="product-item position-relative bg-white d-flex flex-column text-center">
                    {% if item.image %}
                        <img class="img-fluid mb-4" src="{{ item.image.url }}" alt="{{ item.title }}">
                    {% else %}
                        <img class="img-fluid mb-4" src="{% static 'img/product-placeholder.png' %}" alt="{{ item.title }}">
                    {% endif %}
                    <h6 class="mb-3">{{ item.title|truncatechars:20 }}</h6>
                    <h5 class="text-primary mb-0">
                        {% if item.discount_price %}
                            ${{ item.discount_price }}
                        {% else %}
                            ${{ item.price }}
                        {% endif %}
                    </h5>
                    <div class="btn-action d-flex justify-content-center">
                        <a class="btn bg-primary py-2 px-3" href="{{ item.get_add_to_cart_url }}" title="Add to Cart">
                            <i class="bi bi-cart text-white"></i>
                        </a>
                        <a class="btn bg-secondary py-2 px-3" href="{{ item.get_absolute_url }}" title="View Details">
                            <i class="bi bi-eye text-white"></i>
                        </a>
                    </div>
                </div>
            </div>
            {% empty %}
            <!-- Fallback static products if no database items -->
            <div class="pb-5">
                <div class="product-item position-relative bg-white d-flex flex-column text-center">
                    <img class="img-fluid mb-4" src="{% static 'img/product-1.png' %}" alt="Organic Vegetable">
                    <h6 class="mb-3">Organic Vegetable</h6>
                    <h5 class="text-primary mb-0">$19.00</h5>
                    <div class="btn-action d-flex justify-content-center">
                        <a class="btn bg-primary py-2 px-3" a href="{% url 'core:products' %}"><i class="bi bi-cart text-white"></i></a>
                        <a class="btn bg-secondary py-2 px-3" a href="{% url 'core:products' %}"><i class="bi bi-eye text-white"></i></a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
<!-- Products Carousel End -->

<!-- Featured Products Section Start -->
<section class="ftco-section">
    <div class="container">
        <div class="row justify-content-center mb-3 pb-3">
            <div class="col-md-12 heading-section text-center ftco-animate">
                <span class="subheading">Featured Products</span>
                <h2 class="mb-4">Our Products</h2>
                <p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia</p>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            {% for item in object_list %}
            <div class="col-md-6 col-lg-3 ftco-animate">
                <div class="product">
                    <a href="{{ item.get_absolute_url }}" class="img-prod">
                        {% if item.image %}
                            <img class="img-fluid" src="{{ item.image.url }}" alt="{{ item.title }}">
                        {% else %}
                            <img class="img-fluid" src="{% static 'img/product-placeholder.jpg' %}" alt="{{ item.title }}">
                        {% endif %}
                        {% if item.discount_price %}
                            {% widthratio item.price|floatformat:0|add:0 item.discount_price|floatformat:0|add:0 100 as discount_percent %}
                            {% widthratio 100 1 discount_percent as actual_discount %}
                            <span class="status">{{ actual_discount|floatformat:0 }}%</span>
                        {% endif %}
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3 text-center">
                        <h3><a href="{{ item.get_absolute_url }}">{{ item.title }}</a></h3>
                        <div class="d-flex">
                            <div class="pricing">
                                <p class="price">
                                    {% if item.discount_price %}
                                        <span class="mr-2 price-dc">${{ item.price }}</span>
                                        <span class="price-sale">${{ item.discount_price }}</span>
                                    {% else %}
                                        <span>${{ item.price }}</span>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        <div class="bottom-area d-flex px-3">
                            <div class="m-auto d-flex">
                                <a href="{{ item.get_absolute_url }}" class="add-to-cart d-flex justify-content-center align-items-center text-center" title="View Details">
                                    <span><i class="ion-ios-menu"></i></span>
                                </a>
                                <a href="{{ item.get_add_to_cart_url }}" class="buy-now d-flex justify-content-center align-items-center mx-1" title="Add to Cart">
                                    <span><i class="ion-ios-cart"></i></span>
                                </a>
                                <!-- Updated Wishlist Link -->
                                {% if user.is_authenticated %}
                                    <a href="{% url 'core:add-to-wishlist' item.slug %}" 
                                       class="heart d-flex justify-content-center align-items-center wishlist-btn" 
                                       title="Add to Wishlist"
                                       data-product-id="{{ item.id }}"
                                       data-product-slug="{{ item.slug }}">
                                        <span><i class="ion-ios-heart"></i></span>
                                    </a>
                                {% else %}
                                    <a href="{% url 'account_login' %}" 
                                       class="heart d-flex justify-content-center align-items-center" 
                                       title="Login to add to wishlist">
                                        <span><i class="ion-ios-heart"></i></span>
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% empty %}
            <!-- Fallback static products if no database items -->
            <div class="col-md-6 col-lg-3 ftco-animate">
                <div class="product">
                    <a href="#" class="img-prod">
                        <img class="img-fluid" src="{% static 'img/product-1.jpg' %}" alt="Bell Pepper">
                        <span class="status">30%</span>
                        <div class="overlay"></div>
                    </a>
                    <div class="text py-3 pb-4 px-3 text-center">
                        <h3><a href="#">Bell Pepper</a></h3>
                        <div class="d-flex">
                            <div class="pricing">
                                <p class="price"><span class="mr-2 price-dc">$120.00</span><span class="price-sale">$80.00</span></p>
                            </div>
                        </div>
                        <div class="bottom-area d-flex px-3">
                            <div class="m-auto d-flex">
                                <a href="#" class="add-to-cart d-flex justify-content-center align-items-center text-center">
                                    <span><i class="ion-ios-menu"></i></span>
                                </a>
                                <a href="#" class="buy-now d-flex justify-content-center align-items-center mx-1">
                                    <span><i class="ion-ios-cart"></i></span>
                                </a>
                                <a href="{% url 'account_login' %}" class="heart d-flex justify-content-center align-items-center">
                                    <span><i class="ion-ios-heart"></i></span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
<!-- Featured Products Section End -->
<!-- Pagination -->
{% if is_paginated %}
<div class="container">
    <nav class="d-flex justify-content-center">
        <ul class="pagination">
            {% if page_obj.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.previous_page_number }}" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            {% endif %}

            <li class="page-item active">
                <a class="page-link" href="?page={{ page_obj.number }}">{{ page_obj.number }}</a>
            </li>

            {% if page_obj.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.next_page_number }}" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
            {% endif %}
        </ul>
    </nav>
</div>
{% endif %}



<!-- Back to Top -->
<a href="#" class="btn btn-secondary py-3 fs-4 back-to-top"><i class="bi bi-arrow-up"></i></a>
{% endblock %}

{% block extra_js %}
<!-- JavaScript Libraries -->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="{% static 'lib/easing/easing.min.js' %}"></script>
<script src="{% static 'lib/waypoints/waypoints.min.js' %}"></script>
<script src="{% static 'lib/counterup/counterup.min.js' %}"></script>
<script src="{% static 'lib/owlcarousel/owl.carousel.min.js' %}"></script>

<!-- Template Javascript -->
<script src="{% static 'js/main.js' %}"></script>
{% endblock %}